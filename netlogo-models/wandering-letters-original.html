<pre><font color="#007f69">globals</font><font color="#000000"><br />[<br />  text        </font><font color="#5a5a5a">;; text to be written</font><font color="#000000"><br />  left-edge   </font><font color="#5a5a5a">;; pxcor of leftmost column where letters can go</font><font color="#000000"><br />  right-edge  </font><font color="#5a5a5a">;; ditto for rightmost</font><font color="#000000"><br />]<br /><br /></font><font color="#007f69">turtles-own</font><font color="#000000"><br />[<br />  word-length </font><font color="#5a5a5a">;; the length of the word the turtle is in</font><font color="#000000"><br />  num-word    </font><font color="#5a5a5a">;; the number the turtle's word is in the text</font><font color="#000000"><br />  leader      </font><font color="#5a5a5a">;; the turtle with the character before this turtle's character</font><font color="#000000"><br />  new-line?   </font><font color="#5a5a5a">;; whether we should start a new line or not</font><font color="#000000"><br />]<br /><br /></font><font color="#5a5a5a">;; setup the variables and the View</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> text (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;These are the times that try men's souls. &quot;</font><font color="#000000"><br />                </font><font color="#5a5a5a">;; the next two sentences each contain all 26</font><font color="#000000"><br />                </font><font color="#5a5a5a">;; letters of the alphabet!  (which makes them</font><font color="#000000"><br />                </font><font color="#5a5a5a">;; good for testing typewriters)</font><font color="#000000"><br />                </font><font color="#963700">&quot;The quick brown fox jumped over the lazy dog. &quot;</font><font color="#000000"><br />                </font><font color="#963700">&quot;Pack my box with five dozen liquor jugs.&quot;</font><font color="#000000">)<br />  draw-margins<br />  </font><font color="#5a5a5a">;; make the turtles &quot;disappear&quot; using a shape that has nothing</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; in it.  we can't use hide-turtle since we want to be able to see the</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; turtle's label</font><font color="#000000"><br />  </font><font color="#0000aa">set-default-shape</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#963700">&quot;blank&quot;</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; create enough turtles to have one for every character in text</font><font color="#000000"><br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> text)<br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> word-length </font><font color="#963700">0</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> leader </font><font color="#963700">nobody</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> new-line? </font><font color="#963700">false</font><font color="#000000"><br />    scatter<br />  ]<br />  setup-letters<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> scatter  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> draw-margins<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />    [ </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> left-margin </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"><br />             (</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> right-margin)<br />        [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> ]<br />        [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000"> ] ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; assign the letters to the turtles, determine who leads them,</font><font color="#000000"><br /></font><font color="#5a5a5a">;; and set how long each word is</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> setup-letters<br />  </font><font color="#0000aa">let</font><font color="#000000"> remaining-text text<br />  </font><font color="#0000aa">let</font><font color="#000000"> word-count </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> prev-letter </font><font color="#963700">nobody</font><font color="#000000"><br /><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">first</font><font color="#000000"> remaining-text<br />    </font><font color="#0000aa">set</font><font color="#000000"> leader prev-letter<br />    </font><font color="#0000aa">set</font><font color="#000000"> num-word word-count<br />    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot; &quot;</font><font color="#000000"><br />    [<br />      </font><font color="#0000aa">set</font><font color="#000000"> word-count word-count </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> num-word num-word </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> remaining-text </font><font color="#660096">but-first</font><font color="#000000"> remaining-text<br />    </font><font color="#0000aa">set</font><font color="#000000"> prev-letter </font><font color="#660096">self</font><font color="#000000"><br />  ]<br /><br />  </font><font color="#0000aa">let</font><font color="#000000"> index </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">repeat</font><font color="#000000"> word-count<br />  [<br />    </font><font color="#0000aa">let</font><font color="#000000"> turtles-in-word </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [num-word </font><font color="#660096">=</font><font color="#000000"> index]<br />    </font><font color="#0000aa">ask</font><font color="#000000"> turtles-in-word<br />      [ </font><font color="#0000aa">set</font><font color="#000000"> word-length </font><font color="#660096">count</font><font color="#000000"> turtles-in-word ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> index index </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; the main procedure called by the GO forever button</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  update-margins<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> new-line? </font><font color="#963700">false</font><font color="#000000"><br />    pick-heading  </font><font color="#5a5a5a">;; choose the heading to the appropriate patch</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; if the turtle is not satisfied with where it is in</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; relation to its leader, go forward a bit</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> happy?<br />      [ </font><font color="#0000aa">move-to</font><font color="#000000"> </font><font color="#660096">patch-here</font><font color="#000000"> ]  </font><font color="#5a5a5a">;; move to center of patch</font><font color="#000000"><br />      [ </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000"> ]<br />  ]<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; updates the left-edge and right-edge variables to match the margin</font><font color="#000000"><br /></font><font color="#5a5a5a">;; sliders, and redraws the margins if necessary</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> update-margins<br />  </font><font color="#0000aa">if</font><font color="#000000"> left-edge </font><font color="#660096">!=</font><font color="#000000"> left-margin </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> left-edge left-margin </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      draw-margins ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> right-edge </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> right-margin </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> right-edge </font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> right-margin </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      draw-margins ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; set the heading of the turtle to the appropriate patch</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> pick-heading<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> leader </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; first letter goes to upper-leftmost patch</font><font color="#000000"><br />    [ </font><font color="#0000aa">face</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> left-edge </font><font color="#660096">max-pycor</font><font color="#000000"> ]<br />    </font><font color="#5a5a5a">;; other patches head toward patch to the right of leader's patch</font><font color="#000000"><br />    [<br />      </font><font color="#0000aa">let</font><font color="#000000"> p [</font><font color="#660096">patch-at</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> leader<br />      </font><font color="#0000aa">if</font><font color="#000000"> p </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"><br />      [ </font><font color="#0000aa">face</font><font color="#000000"> p ]<br />      </font><font color="#0000aa">ifelse</font><font color="#000000"> right-edge </font><font color="#660096">-</font><font color="#000000"> left-edge </font><font color="#660096">&lt;</font><font color="#000000"> word-length<br />      [<br />        </font><font color="#5a5a5a">;; if our word is too long for the width of text,</font><font color="#000000"><br />        </font><font color="#5a5a5a">;; check to see if the patch to the right of the leader is on or over</font><font color="#000000"><br />        </font><font color="#5a5a5a">;; the right margin</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pxcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> leader </font><font color="#660096">&gt;=</font><font color="#000000"> right-edge<br />        [<br />          </font><font color="#5a5a5a">;; if it is change the heading to the beginning of the next line</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> new-line? </font><font color="#963700">true</font><font color="#000000"><br />          </font><font color="#0000aa">face</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> left-edge new-line-pycor<br />        ]<br />      ]<br />      [<br />        </font><font color="#5a5a5a">;; if our word is short enough to fit on a single line but there is not</font><font color="#000000"><br />        </font><font color="#5a5a5a">;; enough room on this particular line, try to word wrap.  that is to say,</font><font color="#000000"><br />        </font><font color="#5a5a5a">;; if the turtle is at the beginning of a word and the word is too long to</font><font color="#000000"><br />        </font><font color="#5a5a5a">;; be completed on a single line given the starting point of the word,</font><font color="#000000"><br />        </font><font color="#5a5a5a">;; have the leader of the word, move to the next line.</font><font color="#000000"><br />        </font><font color="#0000aa">if</font><font color="#000000"> (num-word </font><font color="#660096">!=</font><font color="#000000"> [num-word] </font><font color="#660096">of</font><font color="#000000"> leader) </font><font color="#660096">and</font><font color="#000000"><br />           ([</font><font color="#660096">pxcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> leader </font><font color="#660096">+</font><font color="#000000"> word-length </font><font color="#660096">&gt;=</font><font color="#000000"> right-edge)<br />        [<br />          </font><font color="#5a5a5a">;; if it is change the heading to the beginning of the next line</font><font color="#000000"><br />          </font><font color="#0000aa">set</font><font color="#000000"> new-line? </font><font color="#963700">true</font><font color="#000000"><br />          </font><font color="#0000aa">face</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> left-edge new-line-pycor<br />        ]<br />      ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; reports pycor of the new line the turtle is supposed to go to</font><font color="#000000"><br /></font><font color="#5a5a5a">;; based on the location of its leader and the width of the text</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> new-line-pycor  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">abs</font><font color="#000000"> ([</font><font color="#660096">pycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> leader </font><font color="#660096">-</font><font color="#000000"> line-spacing) </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000"><br />    [ </font><font color="#0000aa">report</font><font color="#000000"> [</font><font color="#660096">pycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> leader ]<br />    [ </font><font color="#0000aa">report</font><font color="#000000"> [</font><font color="#660096">pycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> leader </font><font color="#660096">-</font><font color="#000000"> line-spacing ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; reports true if turtle is satisifed with its current position</font><font color="#000000"><br /></font><font color="#007f69">to-report</font><font color="#000000"> happy?  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> leader </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">  </font><font color="#5a5a5a">;; if the turtle is the first letter...</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; ...is it on the upper-left-most patch that it can be?</font><font color="#000000"><br />    [ </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> left-edge) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">) ]<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> new-line?  </font><font color="#5a5a5a">;; do we want to start a new-line?</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; is the turtle at the beginning of the next line?</font><font color="#000000"><br />    [ </font><font color="#0000aa">report</font><font color="#000000"> (</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> left-edge) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> new-line-pycor) ]<br />      </font><font color="#5a5a5a">;; is the turtle on the patch to the right of its leader?</font><font color="#000000"><br />    [ </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#660096">patch-at</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> [</font><font color="#660096">patch-here</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> leader ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">; Copyright 1997 Uri Wilensky.</font><font color="#000000"><br /></font><font color="#5a5a5a">; See Info tab for full copyright and license.</font>
</pre>
